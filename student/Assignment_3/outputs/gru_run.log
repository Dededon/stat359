
========== Loading Dataset ==========
Dataset loaded. Example: {'sentence': 'According to Gran , the company has no plans to move all production to Russia , although that is where the company is growing .', 'label': 1}

========== Preparing DataFrame ==========
DataFrame shape: (4846, 3)

========== Loading SentenceTransformer Model ==========
Model loaded.

========== Encoding Sentences as Sequences ==========
X_seq shape: (4846, 32, 384), y shape: (4846,)

========== Splitting Data ==========
X_train shape: (3501, 32, 384), y_train shape: (3501,)
X_val shape: (618, 32, 384), y_val shape: (618,)
X_test shape: (727, 32, 384), y_test shape: (727,)
DataLoaders created.

========== Defining GRU Model ==========
Model initialized with input_dim=384, hidden_dim=128, num_layers=2, num_classes=3

========== Setting Up Training ==========
Using device: cuda
Training setup complete.

========== Starting Training Loop ==========

--- Epoch 1/30 ---
Train Loss: 0.8597, Train F1: 0.5385, Train Acc: 0.5670
Val Loss: 0.6923, Val F1: 0.6465, Val Acc: 0.6828
Epoch 1/30: Train Loss: 0.8597 | Train F1: 0.5385 | Train Acc: 0.5670 | Val Loss: 0.6923 | Val F1: 0.6465 | Val Acc: 0.6828
>>> Saved new best model (Val F1: 0.6465)

--- Epoch 2/30 ---
Train Loss: 0.6232, Train F1: 0.6985, Train Acc: 0.7152
Val Loss: 0.6929, Val F1: 0.7188, Val Acc: 0.7443
Epoch 2/30: Train Loss: 0.6232 | Train F1: 0.6985 | Train Acc: 0.7152 | Val Loss: 0.6929 | Val F1: 0.7188 | Val Acc: 0.7443
>>> Saved new best model (Val F1: 0.7188)

--- Epoch 3/30 ---
Train Loss: 0.5392, Train F1: 0.7527, Train Acc: 0.7678
Val Loss: 0.6108, Val F1: 0.7340, Val Acc: 0.7621
Epoch 3/30: Train Loss: 0.5392 | Train F1: 0.7527 | Train Acc: 0.7678 | Val Loss: 0.6108 | Val F1: 0.7340 | Val Acc: 0.7621
>>> Saved new best model (Val F1: 0.7340)

--- Epoch 4/30 ---
Train Loss: 0.4716, Train F1: 0.7820, Train Acc: 0.7961
Val Loss: 0.6354, Val F1: 0.7693, Val Acc: 0.8010
Epoch 4/30: Train Loss: 0.4716 | Train F1: 0.7820 | Train Acc: 0.7961 | Val Loss: 0.6354 | Val F1: 0.7693 | Val Acc: 0.8010
>>> Saved new best model (Val F1: 0.7693)

--- Epoch 5/30 ---
Train Loss: 0.4096, Train F1: 0.8079, Train Acc: 0.8238
Val Loss: 0.6445, Val F1: 0.7502, Val Acc: 0.7735
Epoch 5/30: Train Loss: 0.4096 | Train F1: 0.8079 | Train Acc: 0.8238 | Val Loss: 0.6445 | Val F1: 0.7502 | Val Acc: 0.7735

--- Epoch 6/30 ---
Train Loss: 0.3717, Train F1: 0.8284, Train Acc: 0.8432
Val Loss: 0.6344, Val F1: 0.7586, Val Acc: 0.7751
Epoch 6/30: Train Loss: 0.3717 | Train F1: 0.8284 | Train Acc: 0.8432 | Val Loss: 0.6344 | Val F1: 0.7586 | Val Acc: 0.7751

--- Epoch 7/30 ---
Train Loss: 0.3238, Train F1: 0.8571, Train Acc: 0.8649
Val Loss: 0.6767, Val F1: 0.7222, Val Acc: 0.7379
Epoch 7/30: Train Loss: 0.3238 | Train F1: 0.8571 | Train Acc: 0.8649 | Val Loss: 0.6767 | Val F1: 0.7222 | Val Acc: 0.7379

--- Epoch 8/30 ---
Train Loss: 0.2743, Train F1: 0.8755, Train Acc: 0.8829
Val Loss: 0.8296, Val F1: 0.7816, Val Acc: 0.8123
Epoch 8/30: Train Loss: 0.2743 | Train F1: 0.8755 | Train Acc: 0.8829 | Val Loss: 0.8296 | Val F1: 0.7816 | Val Acc: 0.8123
>>> Saved new best model (Val F1: 0.7816)

--- Epoch 9/30 ---
Train Loss: 0.2328, Train F1: 0.8963, Train Acc: 0.9055
Val Loss: 0.8443, Val F1: 0.7574, Val Acc: 0.7783
Epoch 9/30: Train Loss: 0.2328 | Train F1: 0.8963 | Train Acc: 0.9055 | Val Loss: 0.8443 | Val F1: 0.7574 | Val Acc: 0.7783

--- Epoch 10/30 ---
Train Loss: 0.1895, Train F1: 0.9154, Train Acc: 0.9246
Val Loss: 0.8242, Val F1: 0.7196, Val Acc: 0.7330
Epoch 10/30: Train Loss: 0.1895 | Train F1: 0.9154 | Train Acc: 0.9246 | Val Loss: 0.8242 | Val F1: 0.7196 | Val Acc: 0.7330

--- Epoch 11/30 ---
Train Loss: 0.1641, Train F1: 0.9287, Train Acc: 0.9392
Val Loss: 1.0035, Val F1: 0.7473, Val Acc: 0.7702
Epoch 11/30: Train Loss: 0.1641 | Train F1: 0.9287 | Train Acc: 0.9392 | Val Loss: 1.0035 | Val F1: 0.7473 | Val Acc: 0.7702

--- Epoch 12/30 ---
Train Loss: 0.1320, Train F1: 0.9399, Train Acc: 0.9503
Val Loss: 1.0051, Val F1: 0.7575, Val Acc: 0.7799
Epoch 12/30: Train Loss: 0.1320 | Train F1: 0.9399 | Train Acc: 0.9503 | Val Loss: 1.0051 | Val F1: 0.7575 | Val Acc: 0.7799

--- Epoch 13/30 ---
Train Loss: 0.0862, Train F1: 0.9604, Train Acc: 0.9666
Val Loss: 1.1103, Val F1: 0.7672, Val Acc: 0.8026
Epoch 13/30: Train Loss: 0.0862 | Train F1: 0.9604 | Train Acc: 0.9666 | Val Loss: 1.1103 | Val F1: 0.7672 | Val Acc: 0.8026

--- Epoch 14/30 ---
Train Loss: 0.0583, Train F1: 0.9759, Train Acc: 0.9809
Val Loss: 1.3238, Val F1: 0.7734, Val Acc: 0.7994
Epoch 14/30: Train Loss: 0.0583 | Train F1: 0.9759 | Train Acc: 0.9809 | Val Loss: 1.3238 | Val F1: 0.7734 | Val Acc: 0.7994

--- Epoch 15/30 ---
Train Loss: 0.0408, Train F1: 0.9848, Train Acc: 0.9877
Val Loss: 1.3951, Val F1: 0.7675, Val Acc: 0.7961
Epoch 15/30: Train Loss: 0.0408 | Train F1: 0.9848 | Train Acc: 0.9877 | Val Loss: 1.3951 | Val F1: 0.7675 | Val Acc: 0.7961

--- Epoch 16/30 ---
Train Loss: 0.0327, Train F1: 0.9853, Train Acc: 0.9894
Val Loss: 1.5485, Val F1: 0.7628, Val Acc: 0.7913
Epoch 16/30: Train Loss: 0.0327 | Train F1: 0.9853 | Train Acc: 0.9894 | Val Loss: 1.5485 | Val F1: 0.7628 | Val Acc: 0.7913

--- Epoch 17/30 ---
Train Loss: 0.0235, Train F1: 0.9902, Train Acc: 0.9929
Val Loss: 1.6185, Val F1: 0.7679, Val Acc: 0.7977
Epoch 17/30: Train Loss: 0.0235 | Train F1: 0.9902 | Train Acc: 0.9929 | Val Loss: 1.6185 | Val F1: 0.7679 | Val Acc: 0.7977

--- Epoch 18/30 ---
Train Loss: 0.0243, Train F1: 0.9918, Train Acc: 0.9943
Val Loss: 1.5684, Val F1: 0.7685, Val Acc: 0.7994
Epoch 18/30: Train Loss: 0.0243 | Train F1: 0.9918 | Train Acc: 0.9943 | Val Loss: 1.5684 | Val F1: 0.7685 | Val Acc: 0.7994

--- Epoch 19/30 ---
Train Loss: 0.0190, Train F1: 0.9915, Train Acc: 0.9931
Val Loss: 1.6772, Val F1: 0.7605, Val Acc: 0.7929
Epoch 19/30: Train Loss: 0.0190 | Train F1: 0.9915 | Train Acc: 0.9931 | Val Loss: 1.6772 | Val F1: 0.7605 | Val Acc: 0.7929

--- Epoch 20/30 ---
Train Loss: 0.0146, Train F1: 0.9951, Train Acc: 0.9963
Val Loss: 1.7553, Val F1: 0.7638, Val Acc: 0.7977
Epoch 20/30: Train Loss: 0.0146 | Train F1: 0.9951 | Train Acc: 0.9963 | Val Loss: 1.7553 | Val F1: 0.7638 | Val Acc: 0.7977

--- Epoch 21/30 ---
Train Loss: 0.0098, Train F1: 0.9970, Train Acc: 0.9977
Val Loss: 1.8001, Val F1: 0.7643, Val Acc: 0.7977
Epoch 21/30: Train Loss: 0.0098 | Train F1: 0.9970 | Train Acc: 0.9977 | Val Loss: 1.8001 | Val F1: 0.7643 | Val Acc: 0.7977

--- Epoch 22/30 ---
Train Loss: 0.0105, Train F1: 0.9969, Train Acc: 0.9974
Val Loss: 1.8162, Val F1: 0.7588, Val Acc: 0.7913
Epoch 22/30: Train Loss: 0.0105 | Train F1: 0.9969 | Train Acc: 0.9974 | Val Loss: 1.8162 | Val F1: 0.7588 | Val Acc: 0.7913

--- Epoch 23/30 ---
Train Loss: 0.0095, Train F1: 0.9972, Train Acc: 0.9980
Val Loss: 1.8919, Val F1: 0.7605, Val Acc: 0.7945
Epoch 23/30: Train Loss: 0.0095 | Train F1: 0.9972 | Train Acc: 0.9980 | Val Loss: 1.8919 | Val F1: 0.7605 | Val Acc: 0.7945

--- Epoch 24/30 ---
Train Loss: 0.0066, Train F1: 0.9972, Train Acc: 0.9977
Val Loss: 1.9084, Val F1: 0.7640, Val Acc: 0.7961
Epoch 24/30: Train Loss: 0.0066 | Train F1: 0.9972 | Train Acc: 0.9977 | Val Loss: 1.9084 | Val F1: 0.7640 | Val Acc: 0.7961

--- Epoch 25/30 ---
Train Loss: 0.0065, Train F1: 0.9983, Train Acc: 0.9986
Val Loss: 1.9255, Val F1: 0.7611, Val Acc: 0.7945
Epoch 25/30: Train Loss: 0.0065 | Train F1: 0.9983 | Train Acc: 0.9986 | Val Loss: 1.9255 | Val F1: 0.7611 | Val Acc: 0.7945

--- Epoch 26/30 ---
Train Loss: 0.0070, Train F1: 0.9981, Train Acc: 0.9986
Val Loss: 1.9524, Val F1: 0.7633, Val Acc: 0.7961
Epoch 26/30: Train Loss: 0.0070 | Train F1: 0.9981 | Train Acc: 0.9986 | Val Loss: 1.9524 | Val F1: 0.7633 | Val Acc: 0.7961

--- Epoch 27/30 ---
Train Loss: 0.0065, Train F1: 0.9977, Train Acc: 0.9983
Val Loss: 1.9606, Val F1: 0.7635, Val Acc: 0.7961
Epoch 27/30: Train Loss: 0.0065 | Train F1: 0.9977 | Train Acc: 0.9983 | Val Loss: 1.9606 | Val F1: 0.7635 | Val Acc: 0.7961

--- Epoch 28/30 ---
Train Loss: 0.0057, Train F1: 0.9979, Train Acc: 0.9983
Val Loss: 1.9763, Val F1: 0.7640, Val Acc: 0.7961
Epoch 28/30: Train Loss: 0.0057 | Train F1: 0.9979 | Train Acc: 0.9983 | Val Loss: 1.9763 | Val F1: 0.7640 | Val Acc: 0.7961

--- Epoch 29/30 ---
Train Loss: 0.0057, Train F1: 0.9981, Train Acc: 0.9986
Val Loss: 1.9884, Val F1: 0.7608, Val Acc: 0.7945
Epoch 29/30: Train Loss: 0.0057 | Train F1: 0.9981 | Train Acc: 0.9986 | Val Loss: 1.9884 | Val F1: 0.7608 | Val Acc: 0.7945

--- Epoch 30/30 ---
Train Loss: 0.0047, Train F1: 0.9986, Train Acc: 0.9989
Val Loss: 1.9985, Val F1: 0.7635, Val Acc: 0.7961
Epoch 30/30: Train Loss: 0.0047 | Train F1: 0.9986 | Train Acc: 0.9989 | Val Loss: 1.9985 | Val F1: 0.7635 | Val Acc: 0.7961

========== Plotting Learning Curves ==========
Learning curves saved as 'outputs/gru_f1_learning_curves.png'.
Accuracy curve saved as 'outputs/gru_accuracy_learning_curve.png'.

========== Evaluating on Test Set ==========

==================================================
Final Test Accuracy: 0.7607
Test F1 Macro: 0.7192
Test F1 Weighted: 0.7572
==================================================

Classification Report:
              precision    recall  f1-score   support

Negative (0)     0.6134    0.8022    0.6952        91
 Neutral (1)     0.8129    0.8449    0.8286       432
Positive (2)     0.7233    0.5637    0.6336       204

    accuracy                         0.7607       727
   macro avg     0.7165    0.7369    0.7192       727
weighted avg     0.7628    0.7607    0.7572       727

Confusion matrix saved as 'outputs/gru_confusion_matrix.png'.

Per-class F1 Scores:
Negative (0): 0.6952
Neutral (1): 0.8286
Positive (2): 0.6336

========== Script Complete ==========
